{% extends "layout.html" %}
{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<div class="card">
  <div class="card-body">
    <h2>{{ post.title }}</h2>
    <p>{{ post.content }}</p>
    <p class="text-muted">By {{ post.user.username }}</p>
    {% if user and user.user_id == post.user_id %}
      <a href="{{ url_for('edit_post', post_id=post.id) }}" class="btn btn-warning btn-sm">Edit</a>
      <a href="{{ url_for('delete_post', post_id=post.id) }}" class="btn btn-danger btn-sm">Delete</a>
    {% endif %}
  </div>
</div>

<h4 class="mt-4">Comments</h4>
{% for comment in comments %}
  <div class="comment">
    <p>{{ comment.content }}</p>
    <p class="text-muted">By {{ comment.user.username }}</p>
    {% if user and user.user_id == comment.user_id %}
      <a href="{{ url_for('delete_comment', comment_id=comment.id) }}" class="btn btn-sm btn-danger">Delete</a>
    {% endif %}
  </div>
{% else %}
  <p>No comments yet.</p>
{% endfor %}

{% if user %}
<form method="POST" class="mt-3">
  <div class="mb-3">
    <textarea name="content" rows="3" class="form-control" placeholder="Add a comment..." required></textarea>
  </div>
  <button class="btn btn-primary">Submit Comment</button>
</form>
{% else %}
<p><a href="{{ url_for('login') }}">Login</a> to comment.</p>
{% endif %}
{% endblock %}
